<div [ngClass]="{ hidden: !loading }" class="loading-container">
  <img src="/assets/loading.gif" alt="Loading..." class="loading-gif" />
</div>

<div [ngClass]="{ visible: !loading }" class="pet-container">
  <!-- Image Carousel -->
  <h1 class="pet-page-title">{{ pet.name }}</h1>
  <div *ngIf="pet.pictures && pet.pictures.length" class="carousel">
    <button (click)="prevImage()" class="carousel-control prev">‹</button>
    <img
      [src]="pet.pictures[currentImageIndex]"
      alt="{{ pet.name }}"
      class="carousel-image"
    />
    <button (click)="nextImage()" class="carousel-control next">›</button>
    <button (click)="openModal()" class="expand-button">
      <img
        class="magnifying-glass-icon"
        src="/assets/magnifying-glass.svg"
        alt="expand-arrow"
      />
    </button>
  </div>

  <!-- Modal for expanded image view -->
  <div *ngIf="isModalOpen" class="modal" (click)="handleModalClick($event)">
    <div class="modal-content">
      <span class="close" (click)="closeModal()">&times;</span>
      <button (click)="prevImage()" class="modal-control prev">‹</button>
      <img
        [src]="pet.pictures[currentImageIndex]"
        alt="{{ pet.name }}"
        class="modal-image"
      />
      <button (click)="nextImage()" class="modal-control next">›</button>
    </div>
  </div>

  <!-- Thumbnail Navigation -->
  <div *ngIf="pet.pictures && pet.pictures.length" class="thumbnail-container">
    <img
      *ngFor="let picture of pet.pictures; let i = index"
      [src]="picture"
      [class.active]="i === currentImageIndex"
      (click)="goToImage(i)"
      class="thumbnail-image"
      alt="{{ pet.name }} thumbnail"
    />
  </div>

  <!-- Pet info card (top one) -->
  <div class="pet-details">
    <div class="pet-info">
      <h1 class="pet-page-header">Meet {{ pet.name }}!</h1>
      <div class="pet-attribute">
        <img src="/assets/pet-info-icons/home.svg" alt="Status icon" />
        <p><strong>Status:</strong> {{ pet.status }}</p>
      </div>
      <div class="pet-attribute">
        <img [src]="getAnimalIconPath(pet.animal)" alt="Animal icon" />
        <p><strong>Animal:</strong> {{ pet.animal }}</p>
      </div>
      <div class="pet-attribute">
        <img src="/assets/pet-info-icons/paw.svg" alt="Breed icon" />
        <p><strong>Breed:</strong> {{ pet.breed }}</p>
      </div>
      <div class="pet-attribute">
        <img src="/assets/pet-info-icons/calendar.svg" alt="Age icon" />
        <p><strong>Age:</strong> {{ formatAge(getAge(pet.birthdate)) }} old</p>
      </div>
      <div class="pet-attribute">
        <img [src]="'/assets/gender/' + pet.sex.toLowerCase() + '.svg'" alt="Sex icon" />
        <p><strong>Sex:</strong> {{ pet.sex | titlecase }}</p>
      </div>
      <div class="pet-attribute">
        <img src="/assets/pet-info-icons/location-pin.svg" alt="Location icon" />
        <p><strong>Location:</strong> {{ pet.location }}</p>
      </div>
      <div class="pet-attribute">
        <img src="/assets/pet-info-icons/cash.svg" alt="Price icon" />
        <p><strong>Price:</strong> {{ pet.price | currency }}</p>
      </div>
      <div class="pet-attribute">
        <img src="/assets/pet-info-icons/book.svg" alt="Description icon" />
        <p><strong>Description:</strong> {{ pet.description }}</p>
      </div>
    </div>
  

    <div class="pet-benefits">
      <div *ngIf="pet.benefits && pet.benefits.length">
        <h1 class="pet-page-header">Included:</h1>
        <div class="benefit-item" *ngFor="let benefit of pet.benefits">
          <img src="/assets/pet-info-icons/checkmark.svg" alt="Benefit icon" />
          <span>{{ benefit }}</span>
        </div>
      </div>
    </div>    
  </div>

  <div class="request-contact">
    <div *ngIf="isBuyer" class="button-container">
      <button
        [disabled]="isNotEmptyObject(contactInfo)"
        class="request-button"
        (click)="requestContact()"
      >
        {{
          contactInfo && isNotEmptyObject(contactInfo)
            ? "Contact Received: " + contactInfo.sellerContact
            : "Request Contact"
        }}
      </button>
      <img
        class="request-pawprint-left"
        src="/assets/paw-trail.svg"
        alt="paw print trail"
      />
      <img
        class="request-pawprint-right"
        src="/assets/paw-trail.svg"
        alt="paw print trail"
      />
    </div>
  </div>
</div>
